<p>
  <pre style="background-color: #000000d6; color: #ffffad;">
    <code>
      <hr>
      require 'pg'

      if ARGV.length == 0 then
        puts "Usage: prepare_statement.rb rowId"
      end

      colId = ARGV[0]

      begin
        conn = PG.connect(
          :host => 'localhost',
          :port => '5432', #指定必須ではない
          :dbname => 'janbodnardb',
          :user => 'janbodnar',
          :password => 'janbodnar'
        )

        conn.prepare 'stm1', "SELECT * FROM cars WHERE id=$1"
        rs = conn.exec_prepared 'stm1', [colId]
        puts rs.values

      rescue PG::Error => e
        puts e.message
      ensure
        rs.clear if rs
        conn.close if conn
      end
      <hr>
    </code>
  </pre>
</p>

<P>
  <ul>
    <li>pg gem を require</li>
    <li>prepare で、prepared statement を作成</li>
    <li>exec_prepared で prepared statement を実行。プレースホルダーにバインドする値は、配列で渡す。</li>
  </ul>
</P>